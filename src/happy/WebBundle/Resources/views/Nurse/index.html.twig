{% extends '@happyWeb/Layout/base.html.twig' %}
{% block style %}
    <style>
        .col-lg-2 {
            padding-left: 0;
            padding-right: 0;
        }
    </style>
{% endblock %}
{% block body %}
    <div class="project-type-background">
        <div class="medical-search" style="padding: 10px 0 10px 0;">
            <div class="container">
                {% include  '@happyWeb/inc/inc-nurse-search.html.twig' %}
            </div>
        </div>
        <div class="container" style="text-align: center;margin-bottom: 50px;">
            {% set i = 1 %}

            {% if nurse != null %}
                {% for key,m in nurse %}
                    {% set a = key + 1 %}
                    <a href="javascript:void(0);"
                       class="nurse col-lg-2 col-md-3 col-sm-3  col-xs-6 width {% if a%5 == 0 %} hidden-sm-down{% endif %}"
                       onclick="active({{ m.doctor.id }}, {{ i }}, '{% if m.doctor.photo != null %}/{{ localstatfolder }}{{ m.doctor.photo }}{% else %}{{ asset('recource/nurse-list.jpg') }}{% endif %}','{{ m.doctor.name }}','{{ m.doctor.star }}','{{ m.doctor.turshlaga }}','{{ m.doctor.mergeshil }}' ,'{{ m.doctor.timeTable }}', '/{{ localstatfolder }}{{ m.doctorType.photo }}', '{{ m.doctorType.price }}', '{{ m.doctorType.name }}','{{ m.doctorPosition.name }}')"
                       id="nurse{{ m.id }}" {% if a%5 == 0 %}style="margin-right: 0;"{% endif %}>
                        {% include  '@happyWeb/inc/inc-nurse.html.twig' with {'star': m.doctor.star, 'img': m.doctor.photo, 'phone': m.doctor.phone, 'id': m.doctor.id, 'name' : m.doctor.name } %}
                    </a>
                    {% if a%5 == 0 %}
                        <div class="nurse-block-detail" id="detail{{ i }}" style="display: none;">
                            <a href="javascript:void(0);" onclick="closeHide({{ i }});"><i
                                        style="position: absolute; right: 50px;top: 10px;" class="fa fa-close"></i></a>
                            <div class="nurse-block-detail-img">
                                <img src="" id="detailimg{{ i }}">
                            </div>
                            <div class="nurse-block-detail-text">

                                <h4 id="detailname{{ i }}" style="font-size: 16px"></h4>
                                <div id="detailstar{{ i }}"></div>

                                <div id="detailturshlaga{{ i }}" style="text-align: justify"></div>
                                <div id="detailmergeshil{{ i }}" style="text-align: justify"></div>
                                <div id="detailtime{{ i }}" style="text-align: justify"></div>

                                <a class="btn btn-warning" id="detailhref" style="margin-left: 0;"><i
                                            class="fa fa-phone"></i> Дуудлага
                                    өгөх</a>
                            </div>

                        </div>
                        {% set i = i + 1 %}
                    {% endif %}
                    {% if loop.last %}
                        {% if loop.length%5 !=0 %}
                            <div class="nurse-block-detail" id="detail{{ i }}" style="display: none;">
                                <a href="javascript:void(0);" onclick="closeHide({{ i }});"><i
                                            style="position: absolute; right: 50px;top: 10px;" class="fa fa-close"></i></a>
                                <div class="nurse-block-detail-img">
                                    <img src="" id="detailimg{{ i }}">
                                </div>
                                <div class="nurse-block-detail-text">

                                    <h4 id="detailname{{ i }}" style="font-size: 16px"></h4>
                                    <div id="detailstar{{ i }}"></div>

                                    <div id="detailturshlaga{{ i }}" style="text-align: justify"></div>
                                    <div id="detailmergeshil{{ i }}" style="text-align: justify"></div>
                                    <div id="detailtime{{ i }}" style="text-align: justify"></div>

                                    <a class="btn btn-warning" id="detailhref" style="margin-left: 0;"><i
                                                class="fa fa-phone"></i>
                                        Дуудлага өгөх</a>
                                </div>
                            </div>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            {% else %}
                <p style="font-size: 50px;margin-top: 50px">Уучлаарай, сувилагч олдсонгүй!</p>
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block js %}
    <script>
        function submitData(imgurl, dun, nurseid, nursename, service, position) {
            $('#nurseModal').modal('show');

            $('#suvilagchqr').attr('src', imgurl);
            $('#suvilagchdun').html(dun);

            $.ajax({
                url: "{{ path('cms_nurse_call_register') }}",
                data: {nurseid: nurseid, nursename: nursename, price: dun, service: service, position: position},
                type: "POST",
                dataType: "JSON"
            }).done(function (data) {

            }).error(function () {

            })
        }

        $(document).ready(function () {
            $('input[type="radio"]').change(function () {
                $('#nurseSearch').submit();
            });
        });

        function closeHide(cc) {
            $('#detail' + cc).hide('blind');
        }

        function active(id, key, img, name, star, turshlaga, mergeshil, time, imgurl, dun, service, position) {
            $nurse = $('#nurse' + id);
            $nurse.siblings().removeClass("active");
            $nurse.addClass('active', 500);
            for (i = 1; i <= 5; i++) {
                if (i == key) {

                    $('#detail' + i).hide().show('blind');

                    $('#detailimg' + i).attr('src', img);
                    $('#detailname' + i).text(name);

                    if (star == 0) {
                        starHtml = '<i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i>';
                    }
                    else if (star > 0 && star < 10) {
                        starHtml = '<i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i>';
                    }

                    else if (star > 11 && star < 20) {
                        starHtml = '<i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i>';
                    }

                    else if (star > 21 && star < 30) {
                        starHtml = '<i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i>';
                    }

                    else if (star > 31 && star < 40) {
                        starHtml = '<i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star-o" style="color: #ff7020"></i>';
                    }

                    else {
                        starHtml = '<i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i> <i class="fa fa-star" style="color: #ff7020"></i>';
                    }
                    $('#detailstar' + i).html(starHtml);
                    $('#detailturshlaga' + i).html('<b>Ажлын туршлага:</b>' + '<p>' + turshlaga + '</p>');
                    $('#detailmergeshil' + i).html('<b>Мэргэшсэн чиглэл:</b>' + '<p>' + mergeshil + '</p>');
                    $('#detailtime' + i).html('<b>Боломжит цагийн хуваарь:</b>' + '<p>' + time + '</p>');

                }
                else {
                    $('#detail' + i).hide('blind');
                }
            }

            $('#detailhref').attr('onclick', "submitData('" + imgurl + "','" + dun + "','" + id + "','" + name + "','" + service + "','" + position + "')");
        }
    </script>
{% endblock %}